"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function e(t,n,r){function o(i,s){if(!n[i]){if(!t[i]){var l="function"==typeof require&&require;if(!s&&l)return l(i,!0);if(a)return a(i,!0);var d=new Error("Cannot find module '"+i+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(e){var n=t[i][1][e];return o(n?n:e)},c,c.exports,e,t,n,r)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t,n){!function(t){function n(t,n){var r=this.options=n;this.uriToLabels={},this.debugOn=n.debugOn&&window.console,r.UI.docInfo&&(this.docInfo=r.UI.docInfo);var a;a=r.connection.endpoint?r.connection:{endpoint:r.connection["http:"].endpoint,defaultParams:r.endpoints.all,headers:{Accept:r.connection["http:"].accepts},jsonp:r.endpoints.jsonp};var i=e("../../src/http-client.js"),s=e("../../src/sparql-client.js");this.sparqlClient=s.create(i,{connection:a,queries:r.queries||r.connection["http:"].sparql});var l,d=e("../../src/renderer.js");l=r.UI.arrows?r.UI:{arrows:r.arrows,tools:r.UI.tools,nodeIcons:r.UI.nodeIcons,relationships:r.UI.relationships,hashFunc:r.hashFunc},this.renderer=d.create(l),this.refs=this.renderer.refs,this.renderer.boxTemplate=this.boxTemplate=r.boxTemplate||o,r.UI.nodeHover&&(this.renderer.msg=r.UI.nodeHover),this.renderer.init(this,t),this.container=this.renderer.container,this.context=this.renderer.context}var r=(t(window),t(document.body),e("../../src/utils.js")),o='<div class="boxWrapper lodlive-node defaultBoxTemplate"><div class="ll-node-anchor"></div><div class="lodlive-node-label box sprite"></div></div>';n.prototype.init=function(e){this.imagesMap={},this.mapsMap={},this.infoPanelMap={},this.connection={},this.ignoreBnodes=this.options.UI.ignoreBnodes,this.doInverse=!0,this.doAutoExpand=!0,this.doAutoSameas=!0,this.doCollectImages=!1,this.doDrawMap=!1,this.classMap={counter:Math.floor(13*Math.random())+1};var t=this.renderer.firstBox(e);this.openDoc(e,t),this.renderer.msg("","init"),this.createLozengeCheckbox()},n.prototype.autoExpand=function(){var e=this;e.context.find(".relatedBox:not([class*=exploded])").each(function(){var n=t(this),r=n.attr("relmd5");e.context.children("#"+r).length&&n.click()})},n.prototype.addNewDoc=function(e,n){var o=this,a=!0,i=null,s=n.attr("rel"),l=n.attr("relmd5"),d=n.data("circleid"),c=n.data("property"),p=n.is(".inverse");if(!p){if(o.refs.getObjectRefs(d).indexOf(l)>-1)return;o.refs.addObjectRef(d,l),o.refs.addSubjectRef(l,d)}var u=o.context.find("#"+l);if(u.length||(a=!1,u=t(o.boxTemplate).attr("id",l).attr("rel",s)),n.hide(),!a){var f=parseInt(n.attr("data-circlePos"),10),h=parseInt(n.attr("data-circleParts"),10),v=h>10?2+f%2:2.5,g=r.circleChords(e.width()*v,h,e.position().left+e.width()/2,e.position().top+e.height()/2,null,f);o.context.append(u),u.css({left:g[0][0]-u.height()/2,top:g[0][1]-u.width()/2,opacity:1,zIndex:99}),p&&(i=o.context.find('div[data-property="'+c+'"][rel="'+s+'"]')),o.openDoc(s,u,i)}if(!p){var y=[];c.split("|").forEach(function(e){var t=e.trim();y.push(o.generateLabelAjaxCall(t))}),Promise.all(y).then(function(t){o.renderer.drawLine(e,u,null,c,o.uriToLabels)})}},n.prototype.removeDoc=function(e,n){var r=this,o=1==r.context.find(".lodlive-node").length;if(o)return void alert("Cannot Remove Only Box");r.context.find(".lodlive-toolbox").remove();var a=e.attr("id");r.renderer.clearLines(a);var i=r.refs.getSubjectRefs(a),s=r.refs.getObjectRefs(a);i.forEach(function(e){r.refs.removeObjectRef(e,a)}),s.forEach(function(e){r.refs.removeSubjectRef(e,a)});var l=r.renderer.getRelatedNodePairs(a,!0);r.renderer.drawLines(l),r.refs.removeAsSubject(a),r.refs.removeAsObject(a),r.docInfo(),e.fadeOut("normal",null,function(){e.remove(),r.context.find("div[relmd5="+a+"]").each(function(){var e=t(this);e.show(),e.removeClass("exploded")})})},n.prototype.docInfo=function(e){var n,r=this,o=r.container.find(".lodlive-docinfo");return null==e||(n=e.attr("rel"))&&o.is('[rel="'+n+'"]')?(console.log("hiding docInfo"),void o.fadeOut("fast").removeAttr("rel")):(o.length||(o=t('<div class="lodlive-docinfo" rel="'+n+'"></div>'),r.container.append(o)),o.attr("rel",n),void r.sparqlClient.document(n,{success:function(e){o.empty().fadeIn(),r.formatDoc(o,e.values,e.uris,e.bnodes,n)},error:function(e,t,a){var i=[{"http://system/msg":"Could not find document: "+n}];r.formatDoc(o,i,[],[],n)}}))},n.prototype.formatDoc=function(e,t,n,r,o){var a=this,i=a.getJsonValue(n,"http://www.w3.org/1999/02/22-rdf-syntax-ns#type","default");if(e.addClass(a.getProperty("document","className",i)),!t.length&&!r.length)return e.append(a.renderer.docInfoMissing());var s=a.getProperty("images","properties",i),l=a.getProperty("weblinks","properties",i);a.getProperty("document","propertiesMapper",o.replace(/(http:\/\/[^\/]+\/).+/,"$1"));Array.isArray(s)||(s=[s]),Array.isArray(l)||(l=[l]);var d=[],c=[],p=[];n.forEach(function(e){var t=Object.keys(e)[0],n=e[t],r={};"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"!==t?(r[t]=n,s.indexOf(t)>-1?d.push(r):l.indexOf(t)>-1&&c.push(r)):p.push(n)}),e.append(a.renderer.docInfoTypes(p)),e.append(a.renderer.docInfoImages(d)),e.append(a.renderer.docInfoLinks(c)),e.append(a.renderer.docInfoValues(t));var u=a.renderer.docInfoBnodes(r);u.forEach(function(t){e.append(t.bnodeNode),a.resolveBnodes(t.value,o,t.spanNode,e)})},n.prototype.resolveBnodes=function(e,t,n,r){var o=this;o.sparqlClient.bnode(e,{beforeSend:function(){return o.renderer.loading(n)},success:function(e){e.values.length&&o.renderer.docInfoBnodeValues(e.values,n),e.bnodes.forEach(function(e){var a=Object.keys(e)[0],i=e[i],s=o.renderer.docInfoNestedBnodes(a,n);o.resolveBnodes(i,t,s,r)})},error:function(e,t,n){}})},n.prototype.getJsonValue=function(e,n,r){var o,a=this;a.debugOn&&(o=(new Date).getTime());var i=[];return t.each(e,function(e,t){for(var r in t)r==n&&i.push(t[r])}),i==[]&&(i=[r]),a.debugOn&&console.debug((new Date).getTime()-o+"  getJsonValue"),i},n.prototype.getProperty=function(e,t,n){var r,o=this,a=o.options;if(o.debugOn&&(r=(new Date).getTime()),Array.isArray(n)){for(var i=0;i<n.length;i++)if(a[n[i]]&&a[n[i]][e])return t?a[n[i]][e][t]?a[n[i]][e][t]:a["default"][e][t]:a[n[i]][e]?a[n[i]][e]:a["default"][e]}else if(n+="",a[n]&&a[n][e])return t?a[n][e][t]?a[n][e][t]:a["default"][e][t]:a[n][e]?a[n][e]:a["default"][e];return o.debugOn&&console.debug((new Date).getTime()-r+"  getProperty"),a["default"][e]?t?a["default"][e][t]:a["default"][e]:""},n.prototype.format=function(e,n,o,a){function i(e,t){var n={},r=[];return e.forEach(function(e){var o,a,i,s=Object.keys(e)[0],l=e[s],d={};"uris"===t&&m.indexOf(s)>-1||"inverses"===t&&"bnode"==h&&l.indexOf("~~")>-1||(n.hasOwnProperty(l)?(i=n[l],a=Object.keys(r[i])[0],o=a+" | "+s,d[o]=l,r[i]=d):(r.push(e),n[l]=r.length-1))}),r}function s(e){var t={};return e.forEach(function(e){var n=Object.keys(e)[0],r=e[n];t.hasOwnProperty(n)?t[n].push(r):t[n]=[r]}),t}var l,d=this,c=d.classMap;d.options;d.debugOn&&(l=(new Date).getTime());var p=e.parent("div"),u=p.find(".ll-node-anchor"),f=p.attr("rel")||"",h=d.getJsonValue(o,"http://www.w3.org/1999/02/22-rdf-syntax-ns#type","default");f.indexOf("~~")!=-1&&(h="bnode");var v=d.getProperty("document","className",h);"bnode"==h&&(v="bnode"),null!=v&&"standard"!=v&&""!=v||(c[h]?v=c[h]:(v="box"+c.counter,13===c.counter?c.counter=1:c.counter+=1,c[h]=v)),p.addClass(v);var g=d.getProperty("document","titleProperties",h),y=d.getProperty("images","properties",h),m=d.getProperty("weblinks","properties",h),b=d.getProperty("maps","lats",h),x=d.getProperty("maps","longs",h),w=d.getProperty("maps","points",h);"string"==typeof g&&(g=[g]),"string"==typeof y&&(y=[y]),"string"==typeof m&&(m=[m]),"string"==typeof b&&(b=[b]),"string"==typeof x&&(x=[x]),"string"==typeof w&&(w=[w]),g.push("http://system/msg");var I=[];g.forEach(function(e){var r;0!==e.indexOf("http")?I.push(t.trim(e)):(r=d.getJsonValue(n,e,0===e.indexOf("http")?"":e),r.forEach(function(e){I.push(e)}))});var j=I.filter(function(e,t,n){return n.indexOf(e)===t}).join("\n");if(0==o.length&&0==n.length)j=r.lang("resourceMissing");else if(j||"bnode"!==h){if(!j){j="(Error)";try{j=d.options["default"].document.titleName[f]}catch(C){j=d.options["default"].document.titleProperties[f]}}}else j="[blank node]";d.renderer.addBoxTitle(j,f,e,p);var T=[],S=[],L={},$={};T=i(o,"uris"),a&&(S=i(a,"inverses")),L=s(T),$=s(S);var E=r.circleChords(75,24,e.position().left+65,e.position().top+65),O=r.circleChords(95,36,e.position().left+65,e.position().top+65),R=d.renderer.createPropertyBoxes(T,L,p,E,O,!1),k=d.renderer.createPropertyBoxes(S,$,p,E,O,!0,R.objectList.length+1),P=R.objectList.concat(k.objectList),B=R.innerObjectList.concat(k.innerObjectList);d.renderer.paginateRelatedBoxes(p,P,B,E),d.renderer.generateNodeIcons(u)},n.prototype.openDoc=function(e,n,r){function o(e){a.format(n.children(".box"),e.values,e.uris,s),r&&r.length&&t(r).click(),a.doAutoExpand&&a.autoExpand(n)}var a=this,i=a.options;e||t.error("LodLive: no uri for openDoc"),n.attr("data-endpoint",i.connection["http:"].endpoint);var s=[];a.sparqlClient.documentUri(e,{beforeSend:function(){return a.renderer.loading(n.children(".box"))},success:function(t){return t.bnodes.forEach(function(n){var r=Object.keys(n),o={};r.forEach(function(t){o[t]=e+"~~"+n[t]}),t.uris.push(o)}),delete t.bnodes,a.doInverse?void a.sparqlClient.inverse(e,{beforeSend:function(){return a.renderer.loading(n.children(".box"))},success:function(n){s=n.uris.concat(n.values),n.bnodes.forEach(function(t){var n=Object.keys(t),r={};n.forEach(function(n){r[n]=e+"~~"+t[n]}),s.push(r)}),a.doAutoSameas?a.findInverseSameAs(e,s,function(){o(t)}):o(t)},error:function(e,n,r){o(t)}}):o(t)},error:function(e,t,r){a.renderer.errorBox(n)}})},n.prototype.findInverseSameAs=function(e,n,r){var o=this;if(!o.options.connection["http:"].useForInverseSameAs)return setTimeout(function(){r()},0);var a;o.debugOn&&(a=(new Date).getTime()),o.sparqlClient.inverseSameAs(e,{success:function(e){e=e.results.bindings,t.each(e,function(e,t){var r={},e=t.property&&t.property.value||"http://www.w3.org/2002/07/owl#sameAs";r[e]=t.object.value,n.splice(1,0,r)}),r()},error:function(e,t,n){r()}}),o.debugOn&&console.debug((new Date).getTime()-a+"  findInverseSameAs")},n.prototype.generateLabelAjaxCall=function(e){var n=this;if(null!=n.uriToLabels[e]){var r=new Promise(function(t,n){t(e)});return r}var o=n.options.connection["http:"].endpoint+"?query="+encodeURIComponent(n.options["default"].sparql.label.replace("{URI}",e)),a=t.get({contentType:"application/json",dataType:"json",url:o}).done(function(t){var r=t.results.bindings;null!=r&&r.length>0&&null!=r[0].label?n.uriToLabels[e]=r[0].label.value:n.uriToLabels[e]=e});return a},n.prototype.createLozengeCheckbox=function(){var e=this,t=document.createElement("div");t.classList.add("flip-div");var n=document.createElement("input");n.type="checkbox",n.id="lozenge-checkbox",n.onclick=function(){e.changeToLozengeView()};var r=document.createElement("label");r.htmlFor="lozenge-checkbox",r.appendChild(document.createTextNode("Change view")),t.appendChild(n),t.appendChild(r);var o=document.getElementById("navbar");document.body.insertBefore(t,o.nextSibling)},n.prototype.changeToLozengeView=function(){Array.from(document.getElementsByClassName("sprite")).forEach(function(e){e.style.height="60px",e.style.borderRadius="20px"});var e=document.getElementById("-2045223458");this.renderer.reDrawLines(t(e))},window.LodLive||(window.LodLive=n),jQuery.fn.lodlive=function(e){return arguments.length?("string"==typeof e&&(e={method:e}),this.each(function(){var r=t(this),o=r.data("lodlive-instance");e.method&&"init"!==e.method.toLowerCase()?n.prototype.hasOwnProperty(e.method)&&r.data("lodlive-instance")?o[e.method].apply(o,e.method.args||[]):jQuery.error("Method "+e.method+" does not exist on jQuery.lodlive"):(o=new n(r,e.profile),r.data("lodlive-instance",o),o.init(e.firstUri))})):this.data("lodlive-instance")}}(jQuery)},{"../../src/http-client.js":3,"../../src/renderer.js":5,"../../src/sparql-client.js":6,"../../src/utils.js":7}],2:[function(e,t,n){function r(e,t,n,r){function o(){l&&l(),l=null,s.isDragging=!1,s.target=null,s.panning=!1}var a=$(window),i=t.parent(),s={},l=null;e.on("mousemove",function(e){var t=e.clientX,n=e.clientY,o=s.lastx,d=s.lasty;s.lastx=t,s.lasty=n,s.target?(s.isDragging||(s.isDragging=!0,l=r(s),s.scrollX=i.scrollLeft()+a.scrollLeft()-i.offset().left-s.offsetX,s.scrollY=i.scrollTop()+a.scrollTop()-i.offset().top-s.offsetY),requestAnimationFrame(function(){s.target&&s.target.css({left:t+s.scrollX,top:n+s.scrollY})})):s.panning&&requestAnimationFrame(function(){i.scrollLeft(i.scrollLeft()+o-t),i.scrollTop(i.scrollTop()+d-n)})}),e.on("mousedown",n,function(e){s.target=$(this),s.panning=!1,s.offsetX=e.offsetX,s.offsetY=e.offsetY,e.stopPropagation(),e.preventDefault()}),e.on("mousedown",function(e){s.target=null,s.panning=!0,e.stopPropagation(),e.preventDefault()}),e.on("mouseup",o),$(document).on("keydown",function(e){27===e.keyCode&&o()})}t.exports=r},{}],3:[function(e,t,n){var r={create:function(e){function t(t){return e.defaultParams?"object"===_typeof(e.defaultParams)?$.param($.extend({},e.defaultParams,t)):e.defaultParams+"&"+$.param(t):$.param(t)}if(!e.endpoint)throw new Error("missing required connection.endpoint for httpClient");return function(n,r){var o,a=e.endpoint+"?"+t(n);$.ajax({url:a,contentType:"application/json",dataType:e.jsonp?"jsonp":"json",headers:e.headers||{},beforeSend:function(){r.beforeSend&&(o=r.beforeSend())},success:function(){o&&o(),r.success&&r.success.apply(null,arguments)},error:function(){o&&o(),r.error&&r.error.apply(null,arguments)}})}}};t.exports=r,window.httpClientFactory||(window.httpClientFactory=r)},{}],4:[function(e,t,n){function r(){}r.prototype.getObjectRefs=function(e){return this.storeIds["gen"+e]||[]},r.prototype.setObjectRefs=function(e,t){this.storeIds["gen"+e]=t},r.prototype.addObjectRef=function(e,t){var n=this.getObjectRefs(e);n.indexOf(t)===-1&&n.push(t),this.setObjectRefs(e,n)},r.prototype.removeObjectRef=function(e,t){var n=this.getObjectRefs(e),r=n.indexOf(t);r>-1&&n.splice(r,1)},r.prototype.removeAsObject=function(e){delete this.storeIds["rev"+e]},r.prototype.getSubjectRefs=function(e){return this.storeIds["rev"+e]||[]},r.prototype.setSubjectRefs=function(e,t){this.storeIds["rev"+e]=t},r.prototype.addSubjectRef=function(e,t){var n=this.getSubjectRefs(e);n.indexOf(t)===-1&&n.push(t),this.setSubjectRefs(e,n)},r.prototype.removeSubjectRef=function(e,t){var n=this.getSubjectRefs(e),r=n.indexOf(t);r>-1&&n.splice(r,1)},r.prototype.removeAsSubject=function(e){delete this.storeIds["gen"+e]};var o={create:function(){var e=Object.create(r.prototype);return e.storeIds={},e}};t.exports=o,window.refStoreFactory||(window.refStoreFactory=o)},{}],5:[function(e,t,n){function r(e){return this instanceof r?(this.refs=a.create(),this.hashFunc=e.hashFunc||o.hashFunc,this.arrows=e.arrows,this.tools=e.tools,this.nodeIcons=e.nodeIcons,void(this.relationships=e.relationships)):new r(e)}var o=e("./utils.js"),a=e("./ref-store.js"),i={docInfo:'<div class="actionBox docInfo" rel="docInfo"><span class="fa fa-list"></span></div>',tools:'<div class="actionBox tools" rel="tools"><span class="fa fa-cog"></span></div>'},s={expand:{title:"Expand all",icon:"fa fa-arrows-alt",handler:function(e,t){var n=0,r=e.find(".relatedBox:visible"),o=r.length,a=function i(){var e=r.eq(n++);e.length&&e.click(),n<o&&window.setTimeout(i,120)};window.setTimeout(a,120)}},info:{title:"More info",icon:"fa fa-info-circle",handler:function(e,t){}},rootNode:{title:"Make root node",icon:"fa fa-dot-circle-o",handler:function(e,t){t.context.empty(),t.init(e.attr("rel"))}},remove:{title:"Remove this node",icon:"fa fa-trash",handler:function(e,t){t.removeDoc(e)}},openPage:{title:"Open in another page",icon:"fa fa-external-link",handler:function(e,t){window.open(e.attr("rel"))}}};r.prototype.loading=function(e){var t=e.height()/2-8,n=$('<img class="loader" style="margin-top:'+t+'px" src="img/ajax-loader.gif"/>');return e.append(n),function(){n.remove()}},r.prototype.firstBox=function(e){var t=this,n=t.context,r=n.height(),o=n.width();n.parent().scrollTop(r/2-n.parent().height()/2+60),n.parent().scrollLeft(o/2-n.parent().width()/2+60);var a=(r-65)/2+(n.scrollTop()||0),i=(o-65)/2+(n.scrollLeft()||0),s=$(t.boxTemplate).attr("id",t.hashFunc(e)).attr("rel",e).css({left:i,top:a,opacity:0,zIndex:1}).animate({opacity:1},1e3);return t.context.append(s),s},r.prototype.generateNodeIcons=function(e){var t=this;t.nodeIcons.forEach(function(t){var n;t.builtin?n=jQuery(i[t.builtin]||'<span class="no such builtin"></span>'):(n=$('<div class="actionBox custom"></div>').data("action-handler",t.handler),$("<span></span>").addClass(t.icon).attr("title",t.title).appendTo(n)),n.appendTo(e)})},r.prototype.generateTools=function(e,t,n){var r=this,a=e.find(".lodlive-toolbox");if(!a.length){a=$('<div class="lodlive-toolbox"></div>').hide(),r.tools.forEach(function(e){if(e.builtin&&(e=s[e.builtin]),e){var r=$("<span></span>").addClass(e.icon);$("<div></div>").addClass("innerActionBox").attr("title",o.lang(e.title)).append(r).appendTo(a).on("click",function(){e.handler.call($(this),t,n)})}});var i=$('<div class="lodlive-toolbox-wrapper"></div>').append(a);e.append(i)}return a},r.prototype.reDrawLines=function(e){function t(){n.clearLines(a),n.drawLines(o),i&&requestAnimationFrame(t)}var n=this,r=e.attr("id"),o=n.getRelatedNodePairs(r);if(o&&o.length){var a=n.getRelatedCanvases(r),i=!0;return requestAnimationFrame(t),function(){i=!1}}},r.prototype.docInfoMissing=function(){var e=$('<div class="section"></div>'),t=$("<div></div>").text(o.lang("resourceMissingDoc")),n=$("<label></label>").attr("data-title",o.lang("resourceMissingDoc"));return e.append(n).append(t),e},r.prototype.docInfoTypes=function(e){if(!e.length)return null;var t=$('<label data-title="http://www.w3.org/1999/02/22-rdf-syntax-ns#type">type</label>'),n=$("<div></div>");e.forEach(function(e){var t=$("<span></span>").attr("title",e).text(o.shortenKey(e)+" ");n.append(t)});var r=$('<div class="section"></div>').append(t).append(n);return r},r.prototype.docInfoImages=function(e){if(!e.length)return null;var t=$('<div class="section" style="height:80px"></div>');return e.forEach(function(e){var n=Object.keys(e)[0],r=e[n],a=$("<a></a>").attr("href",r),i=$("<img/>").attr("src",r);a.append(i),t.append(a),i.load(function(){var e=i.width(),t=i.height();e>t?(i.height(80*t/e),i.width(80)):(i.width(80*e/t),i.height(80))}),i.error(function(){i.attr("title",o.lang("noImage")+" \n"+i.attr("src"))})}),t},r.prototype.docInfoLinks=function(e){if(!e.length)return null;var t=$('<div class="section"></div>'),n=$('<ul style="padding:0;margin:0;display:block;overflow:hidden;tex-overflow:ellipses"></ul>');return e.forEach(function(e){var t=Object.keys(e)[0],r=e[t],o=$("<li></li>"),a=$('<a class="relatedLink" target="_blank"></a>').attr("data-title",t+" \n "+r).attr("href",r).text(r);o.append(a),n.append(o)}),t.append(n),t},r.prototype.docInfoValues=function(e){if(!e.length)return null;var t=$("<div></div>");return e.forEach(function(e){var n=Object.keys(e)[0],r=e[n],a=o.shortenKey(n),i=$('<div class="section"></div>'),s=$("<label></label>").attr("data-title",n).text(a),l=$("<div></div>").text(r);i.append(s).append(l),t.append(i)}),t},r.prototype.docInfoBnodes=function(e){return e.map(function(e){var t=Object.keys(e)[0],n=e[t],r=o.shortenKey(t),a=$('<div class="section"></div>'),i=$("<label></label>").attr("data-title",t).text(r),s=$('<span class="bnode"></span>');return a.append(i).append(s),{value:n,spanNode:s,bnodeNode:a}})},r.prototype.docInfoBnodeValues=function(e,t){t.attr("class",""),e.forEach(function(e){var n=Object.keys(e)[0],r=e[n],a=o.shortenKey(n),i=$("<em></em>").attr("title",n).text(a),s=$("<span></span>").text(": "+r),l=$("<div></div>").append(i).append(s);t.append(l)})},r.prototype.docInfoNestedBnodes=function(e,t){var n=$("<span></span>"),r=$("<label></label").attr("data-title",e).text(o.shortenKey(e)),a=$('<span class="bnode"></span>');return n.append(r).append(a),t.attr("class","").append(n),a},r.prototype.addBoxTitle=function(e,t,n,r){var a=$("<div></div>").addClass("boxTitle");if(e===o.lang("resourceMissing"))a.append('<a target="_blank" href="'+t+'">'+t+"</a>").append('<span class="spriteLegenda"></span>');else{e||(e=o.lang("noName"));var i=$('<span class="ellipsis_text"></span>');i.text(e),a.append(i)}a.attr("data-tooltip",e),n.append(a)},r.prototype.createPropertyBoxes=function(e,t,n,r,o,a,i){var s=this,l=null!=i?i:1,d={},c=1,p=[],u=[];return e.forEach(function(e,i){15===l&&(l=1);var f=Object.keys(e)[0],h=null;if(t[f]&&t[f].length>1){if(!d[f]){c=1,d[f]=!0;var v=s.createPropertyGroup(f,t[f],r,l,a);p.push(v),l++}c<25&&(h=s.createGroupedRelatedBox(f,e[f],n,o,c,a),u.push(h)),c++}else n.attr("rel")!==e[f]&&(h=s.createRelatedBox(f,e[f],n,r,l,a),p.push(h),l++)}),{objectList:p,innerObjectList:u}},r.prototype.getRelationshipCSS=function(e){return this.relationships&&this.relationships[e]||{}},r.prototype.createPropertyGroup=function(e,t,n,r,a){var i=this,s=$("<div></div>").addClass("groupedRelatedBox").attr("rel",i.hashFunc(e).toString()).attr("data-property",e).attr("data-title",e+" \n "+t.length+" "+o.lang("connectedResources")).attr("title",e).css(i.getRelationshipCSS(e)).css({top:n[r][1]-8+"px",left:n[r][0]-8+"px"});return a&&(s.addClass("inverse"),s.attr("rel",i.hashFunc(e).toString()+"-i")),t[0].indexOf("~~")>-1?s.addClass("isBnode"):e.split(" ").forEach(function(e){i.arrows[e]&&s.addClass(i.arrows[e])}),s},r.prototype.createGroupedRelatedBox=function(e,t,n,r,o,a){var i=this._createRelatedBox(e,t,n,a).addClass("aGrouped").attr("data-circlePos",o).attr("data-circleParts",36).attr("title",e).css({display:"none",position:"absolute",top:r[o][1]-8+"px",left:r[o][0]-8+"px"});return a?i.addClass(this.hashFunc(e).toString()+"-i"):i.addClass(this.hashFunc(e).toString()),i},r.prototype.createRelatedBox=function(e,t,n,r,o,a){return this._createRelatedBox(e,t,n,a).attr("data-circlePos",o).attr("data-circleParts",24).attr("title",e).css({top:r[o][1]-8+"px",left:r[o][0]-8+"px"})},r.prototype._createRelatedBox=function(e,t,n,r){var o=this,a=$("<div></div>").addClass("relatedBox "+o.hashFunc(t).toString()).attr("rel",t).attr("relmd5",o.hashFunc(t).toString()).attr("data-title",e+" \n "+t).attr("data-circleid",n.attr("id")).attr("data-property",e).css(o.getRelationshipCSS(e));return r&&a.addClass("inverse"),t.indexOf("~~")>-1?a.addClass("isBnode"):e.split(" ").forEach(function(e){o.arrows[e]&&a.addClass(o.arrows[e])}),a},r.prototype.paginateRelatedBoxes=function(e,t,n,r){var o=0,a=r[0],i=r[15],s=t.length>14?t.length/14+(t.length%14>0?1:0):1;t.forEach(function(t,n){var r,l,d;n%14===0&&(o++,r=$("<div></div>").addClass("page page"+o).attr("style","display:none"),o>1&&s>1&&(l=$("<div></div>").addClass("llpages pagePrev").addClass("fa fa-arrow-left").attr("data-page","page"+(o-1)).attr("style","top:"+(a[1]-8)+"px;left:"+(a[0]-8)+"px"),r.append(l)),s>1&&o<s-1&&(d=$("<div></div>").addClass("llpages pageNext").addClass("fa fa-arrow-right").attr("data-page","page"+(o+1)).attr("style","top:"+(i[1]-8)+"px;left:"+(i[0]-8)+"px"),r.append(d)),e.append(r)),e.children(".page"+o).append(t)});var l=$('<div class="innerPage"></div>');n.forEach(function(e){l.append(e)}),n.length>0&&e.append(l),e.children(".page1").fadeIn("fast")},r.prototype.getRelatedCanvases=function(e){var t=[],n=this.refs.getSubjectRefs(e);return t.push($("#line-"+e)),n.forEach(function(e){t.push($("#line-"+e))}),t},r.prototype.clearLines=function(e){var t;t=Array.isArray(e)?e:this.getRelatedCanvases(e),t.forEach(function(e){e.clearCanvas()})},r.prototype.getRelatedNodePairs=function(e,t){var n,r,o=this,a=[],i=o.refs.getObjectRefs(e),s=o.refs.getSubjectRefs(e);return t||(n=o.context.find("#"+e),r=$("#line-"+e),i.forEach(function(e){a.push({from:n,to:o.context.find("#"+e),canvas:r})})),s.forEach(function(n){var r=o.refs.getObjectRefs(n),i=o.context.find("#"+n),s=o.context.find("#line-"+n);r.forEach(function(n){t&&n===e||a.push({from:i,to:o.context.find("#"+n),canvas:s})})}),a},r.prototype.drawLines=function(e){var t,n=this;t=Array.isArray(e)?e:n.getRelatedNodePairs(e),t.forEach(function(e){n.drawLine(e.from,e.to,e.canvas)})},r.prototype.drawLine=function(e,t,n,r,a){var i=this,s=e.position(),l=t.position(),d=e.attr("id"),c=t.attr("id");n||(n=$("#line-"+d)),n.length||(n=$("<canvas></canvas>").attr("height",i.context.height()).attr("width",i.context.width()).attr("id","line-"+d).css({position:"absolute",top:0,left:0,zIndex:"0"}),n.data().lines={},i.context.append(n)),r&&!n.data("propertyName-"+c)&&n.attr("data-propertyName-"+c,r),n.data().lines[c]||(n.data().lines[c]={});var p,u=n.data().lines[c],f=u.lineStyle||"standardLine",h=u.label;h||(p=n.attr("data-propertyName-"+c).split(/\|/),h=p.map(function(e){e=$.trim(e);var t=a[e];return i.arrows[e]&&(f=i.arrows[e]+"Line"),t!==e?t:o.shortenKey(e)}).filter(function(e,t,n){return n.indexOf(e)===t}).join(", "),u.label=h,u.lineStyle=f);var v=s.left+e.width()/2,g=s.top+e.height()/2,y=l.left+t.width()/2,m=l.top+t.height()/2;"isSameAsLine"===f?i.isSameAsLine(h,v,g,y,m,n,c):i.standardLine(h,v,g,y,m,n,c)},r.prototype.standardLine=function(e,t,n,r,o,a,i){var s=180*Math.atan2(o-n,r-t)/Math.PI+180,l=(t-Math.sqrt((r-t)*(r-t)+(o-n)*(o-n))+60,$(a)[0].getContext("2d"));l.beginPath(),l.moveTo(t,n),l.lineTo(r,o),l.strokeStyle="#fff",l.stroke(),l.save();var d=s*Math.PI/180,c="<< "+e,p=10;s>90&&s<270&&(p=-5,c=e+" >>");var u=l.measureText(c).width,f=Math.sqrt(Math.pow(r-t,2)+Math.pow(o-n,2));if(r<t){var h=t,v=n;t=r,r=h,n=o,o=v}var g=t+(f-u)*(r-t)/(2*f),y=n+(f-u)*(o-n)/(2*f);l.align="right",l.translate(g,y),l.rotate(d),s>90&&s<270&&l.rotate(Math.PI),null!=e&&l.fillText(c,0,p),l.restore()},r.prototype.isSameAsLine=function(e,t,n,r,o,a,i){var s=180*Math.atan2(o-n,r-t)/Math.PI+180,l=(t-Math.sqrt((r-t)*(r-t)+(o-n)*(o-n))+60,$(a)[0].getContext("2d"));l.beginPath(),l.moveTo(t,n),l.lineTo(r,o),l.strokeStyle="#000",l.stroke(),l.save();var d=s*Math.PI/180,c="<< "+e,p=10;s>90&&s<270&&(p=-5,c=e+" >>");var u=l.measureText(c).width,f=Math.sqrt(Math.pow(r-t,2)+Math.pow(o-n,2));if(r<t){var h=t,v=n;t=r,r=h,n=o,o=v}var g=t+(f-u)*(r-t)/(2*f),y=n+(f-u)*(o-n)/(2*f);l.align="right",l.translate(g,y),l.rotate(d),s>90&&s<270&&l.rotate(Math.PI),null!=e&&l.fillText(c,0,p),l.restore()},r.prototype.msg=function(e,t,n,r,a){var i,s=this,l=s.container.find(".lodlive-message-container");switch(e||(e=""),t){case"init":l.length||(l=$('<div class="lodlive-message-container"></div>'),s.container.append(l));break;default:l.hide()}l.empty(),e=e.replace(/http:\/\/.+~~/g,""),e=e.replace(/nodeID:\/\/.+~~/g,""),e=e.replace(/_:\/\/.+~~/g,""),e=o.breakLines(e),e=e.replace(/\|/g,"<br />"),i=e.split(" \n "),"fullInfo"===n?(l.append('<div class="endpoint">'+r+"</div>"),2===i.length?(l.append('<div class="from upperline">'+(i[0].length>200?i[0].substring(0,200)+"...":i[0])+"</div>"),l.append('<div class="from upperline">'+i[1]+"</div>")):l.append('<div class="from upperline">'+i[0]+"</div>")):2===i.length?(l.append('<div class="from">'+i[0]+"</div>"),a?l.append('<div class="separ inverse sprite"></div>'):l.append('<div class="separ sprite"></div>'),l.append('<div class="from">'+i[1]+"</div>")):l.append('<div class="from">'+i[0]+"</div>"),l.show()},r.prototype.errorBox=function(e){e.children(".box").addClass("errorBox"),e.children(".box").html("");var t=$('<div class="boxTitle"><span>'+o.lang("endpointNotAvailable")+"</span></div>");e.children(".box").append(t)},r.prototype.initHover=function(){var e=this;this.container.on("mouseenter mouseleave",".lodlive-docinfo label, .lodlive-docinfo a",function(t){return"mouseleave"===t.type?e.msg(null,"hide"):void e.msg($(t.target).data("title"),"show")}),this.container.on("mouseenter mouseleave",".box",function(t){if("mouseleave"===t.type)return e.msg(null,"hide");var n=$(t.target),r=n.is(".errorBox")?o.lang("endpointNotAvailableOrSLow"):n.children(".boxTitle").data("tooltip");e.msg(r,"show","fullInfo",n.parent("div").data("endpoint"))}),this.container.on("mouseenter mouseleave",".relatedBox, .groupedRelatedBox",function(t){if("mouseleave"===t.type)return e.msg(null,"hide");var n=$(t.target);e.msg(n.data("title"),"show",null,null,n.is(".inverse"))})},r.prototype.initClicks=function(e){var t=this;this.container.on("click",".actionBox",function(n){var r=$(n.target).closest(".actionBox"),o=r.closest(".lodlive-node"),a=r.data("action-handler");if(a)return a.call(r,o,e,n);switch(r.attr("rel")){case"docInfo":e.docInfo(o);break;case"tools":t.generateTools(r,o,e).fadeToggle("fast")}}),this.container.on("click",".relatedBox",function(t){var n=$(t.target),r=n.closest(".lodlive-node");n.attr("rel")!=r.attr("rel")&&(n.addClass("exploded"),e.addNewDoc(r,n))}),this.container.on("click",".groupedRelatedBox",function(t){var n=$(t.target),r=n.closest(".lodlive-node");n.data("show")?(n.data("show",!1),e.docInfo(),n.removeClass("lastClick"),r.find("."+n.attr("rel")).fadeOut("fast"),n.fadeTo("fast",1),r.children(".innerPage").hide()):(n.data("show",!0),r.children(".innerPage").show(),e.docInfo(),r.find(".lastClick").removeClass("lastClick").click(),n.addClass("lastClick"),r.find("."+n.attr("rel")+":not([class*=exploded])").fadeIn("fast"),n.fadeTo("fast",.3))}),this.container.on("click",".llpages",function(e){var t=$(e.target),n="."+t.data("page");t.siblings(".lastClick").removeClass("lastClick").click(),t.parent().fadeOut("fast",null,function(){$(this).parent().children(n).fadeIn("fast")})})},r.prototype.init=function(t,n){var r=this;if("string"==typeof n&&(n=$(n)),!n.length)throw new Error("LodLive: no container found");this.container=n.css("position","relative"),this.context=$('<div class="lodlive-graph-context"></div>');var o=$('<div class="lodlive-graph-container"></div>');this.context.appendTo(this.container).wrap(o);var a=e("./draggable.js");a(this.container,this.context,".lodlive-node",function(e){return r.reDrawLines(e.target)}),this.initHover(),this.initClicks(t)};var l={create:function(e){return new r(e)}};t.exports=l,window.LodLiveRenderer||(window.LodLiveRenderer=r),window.rendererFactory||(window.rendererFactory=l)},{"./draggable.js":2,"./ref-store.js":4,"./utils.js":7}],6:[function(e,t,n){function r(e){var t={uris:[],bnodes:[],values:[]};return $.each(e,function(e,n){var r={};r[n.property.value]=n.object.value,"uri"===n.object.type?t.uris.push(r):"bnode"===n.object.type?t.bnodes.push(r):t.values.push(r)}),t}function o(e,t){return this instanceof o?(this.httpClient=e.create(t.connection),void(this.getQueryTemplate=function(e){return t.queries&&t.queries[e]?t.queries[e]:a[e]})):new o(e,t)}var a={documentUri:"SELECT DISTINCT * WHERE {<{URI}> ?property ?object} ORDER BY ?property",document:"SELECT DISTINCT * WHERE {<{URI}> ?property ?object}",bnode:"SELECT DISTINCT *  WHERE {<{URI}> ?property ?object}",inverse:"SELECT DISTINCT * WHERE {?object ?property <{URI}>.} LIMIT 100",inverseSameAs:"SELECT DISTINCT * WHERE {{?object <http://www.w3.org/2002/07/owl#sameAs> <{URI}> } UNION { ?object <http://www.w3.org/2004/02/skos/core#exactMatch> <{URI}>}}"};o.prototype.getQuery=function(e,t){return this.getQueryTemplate(e).replace(/\{URI\}/gi,t.replace(/^.*~~/,""))},o.prototype.document=function(e,t){var n="document",o=this.getQuery(n,e);return this.httpClient({query:o},{beforeSend:t.beforeSend,error:t.error,success:function(e){return e&&e.results&&e.results.bindings?void t.success(r(e.results.bindings)):(console.error(e),t.error(new Error("malformed results")))}})},o.prototype.bnode=function(e,t){var n="bnode",o=this.getQuery(n,e);return this.httpClient({query:o},{beforeSend:t.beforeSend,error:t.error,success:function(e){return e&&e.results&&e.results.bindings?void t.success(r(e.results.bindings)):(console.error(e),
t.error(new Error("malformed results")))}})},o.prototype.documentUri=function(e,t){var n="documentUri",o=this.getQuery(n,e);return this.httpClient({query:o},{beforeSend:t.beforeSend,error:t.error,success:function(e){return e&&e.results&&e.results.bindings?void t.success(r(e.results.bindings)):(console.error(e),t.error(new Error("malformed results")))}})},o.prototype.inverse=function(e,t){var n="inverse",o=this.getQuery(n,e);return this.httpClient({query:o},{beforeSend:t.beforeSend,error:t.error,success:function(e){return e&&e.results&&e.results.bindings?void t.success(r(e.results.bindings)):(console.error(e),t.error(new Error("malformed results")))}})},o.prototype.inverseSameAs=function(e,t){var n="inverseSameAs",r=this.getQuery(n,e);return this.httpClient({query:r},t)};var i={create:function(e,t){return new o(e,t)}};t.exports=i,window.sparqlClientFactory||(window.sparqlClientFactory=i)},{}],7:[function(e,t,n){function r(e,t){c[e]=t}function o(e){c["default"]=c[e]||c["default"]}function a(e,t){var n=t?c[t]||c["default"]:c["default"];return n&&n[e]||e}function i(e){return e=e.replace(/\//g,'/<span style="font-size:1px"> </span>'),e=e.replace(/&/g,'&<span style="font-size:1px"> </span>'),e=e.replace(/%/g,'%<span style="font-size:1px"> </span>')}function s(e){if(!e)return e;for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t}function l(e){e=jQuery.trim(e);var t=e.lastIndexOf("/"),n=e.lastIndexOf("#");return t>n?e.substring(t+1):e.substring(n+1)}function d(e,t,n,r,o,a){var i=[],s=0;if(a){s=a;var l=2*Math.PI*(s/t);i.push([n+e*Math.cos(l),r+e*Math.sin(l)])}else for(;s<t;s++){var l=2*Math.PI*(s/t);i.push([n+e*Math.cos(l),r+e*Math.sin(l)])}return i}var c={},p={registerTranslation:r,setDefaultTranslation:o,lang:a,breakLines:i,hashFunc:s,shortenKey:l,circleChords:d};t.exports=p,window.LodLiveUtils||(window.LodLiveUtils=p)},{}]},{},[1]);